
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>热点新闻分析</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style>
            * { box-sizing: border-box; }
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
                margin: 0; 
                padding: 16px; 
                background: #fafafa;
                color: #333;
                line-height: 1.5;
            }
            
            .container {
                max-width: 600px;
                margin: 0 auto;
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 16px rgba(0,0,0,0.06);
            }
            
            .header {
                background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
                color: white;
                padding: 32px 24px;
                text-align: center;
                position: relative;
            }
            
            .save-buttons {
                position: absolute;
                top: 16px;
                right: 16px;
                display: flex;
                gap: 8px;
            }
            
            .save-btn {
                background: rgba(255, 255, 255, 0.2);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s ease;
                backdrop-filter: blur(10px);
                white-space: nowrap;
            }
            
            .save-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                border-color: rgba(255, 255, 255, 0.5);
                transform: translateY(-1px);
            }
            
            .save-btn:active {
                transform: translateY(0);
            }
            
            .save-btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            
            .header-title {
                font-size: 22px;
                font-weight: 700;
                margin: 0 0 20px 0;
            }
            
            .header-info {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
                font-size: 14px;
                opacity: 0.95;
            }
            
            .info-item {
                text-align: center;
            }
            
            .info-label {
                display: block;
                font-size: 12px;
                opacity: 0.8;
                margin-bottom: 4px;
            }
            
            .info-value {
                font-weight: 600;
                font-size: 16px;
            }
            
            .content {
                padding: 24px;
            }
            
            .word-group {
                margin-bottom: 40px;
            }
            
            .word-group:first-child {
                margin-top: 0;
            }
            
            .word-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 20px;
                padding-bottom: 8px;
                border-bottom: 1px solid #f0f0f0;
            }
            
            .word-info {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .word-name {
                font-size: 17px;
                font-weight: 600;
                color: #1a1a1a;
            }
            
            .word-count {
                color: #666;
                font-size: 13px;
                font-weight: 500;
            }
            
            .word-count.hot { color: #dc2626; font-weight: 600; }
            .word-count.warm { color: #ea580c; font-weight: 600; }
            
            .word-index {
                color: #999;
                font-size: 12px;
            }
            
            .news-item {
                margin-bottom: 20px;
                padding: 16px 0;
                border-bottom: 1px solid #f5f5f5;
                position: relative;
                display: flex;
                gap: 12px;
                align-items: center;
            }
            
            .news-item:last-child {
                border-bottom: none;
            }
            
            .news-item.new::after {
                content: "NEW";
                position: absolute;
                top: 12px;
                right: 0;
                background: #fbbf24;
                color: #92400e;
                font-size: 9px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 4px;
                letter-spacing: 0.5px;
            }
            
            .news-number {
                color: #999;
                font-size: 13px;
                font-weight: 600;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                align-self: flex-start;
                margin-top: 8px;
            }
            
            .news-content {
                flex: 1;
                min-width: 0;
                padding-right: 40px;
            }
            
            .news-item.new .news-content {
                padding-right: 50px;
            }
            
            .news-header {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                flex-wrap: wrap;
            }
            
            .source-name {
                color: #666;
                font-size: 12px;
                font-weight: 500;
            }
            
            .rank-num {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 2px 6px;
                border-radius: 10px;
                min-width: 18px;
                text-align: center;
            }
            
            .rank-num.top { background: #dc2626; }
            .rank-num.high { background: #ea580c; }
            
            .time-info {
                color: #999;
                font-size: 11px;
            }
            
            .count-info {
                color: #059669;
                font-size: 11px;
                font-weight: 500;
            }
            
            .news-title {
                font-size: 15px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .news-link {
                color: #2563eb;
                text-decoration: none;
            }
            
            .news-link:hover {
                text-decoration: underline;
            }
            
            .news-link:visited {
                color: #7c3aed;
            }
            
            .new-section {
                margin-top: 40px;
                padding-top: 24px;
                border-top: 2px solid #f0f0f0;
            }
            
            .new-section-title {
                color: #1a1a1a;
                font-size: 16px;
                font-weight: 600;
                margin: 0 0 20px 0;
            }
            
            .new-source-group {
                margin-bottom: 24px;
            }
            
            .new-source-title {
                color: #666;
                font-size: 13px;
                font-weight: 500;
                margin: 0 0 12px 0;
                padding-bottom: 6px;
                border-bottom: 1px solid #f5f5f5;
            }
            
            .new-item {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 8px 0;
                border-bottom: 1px solid #f9f9f9;
            }
            
            .new-item:last-child {
                border-bottom: none;
            }
            
            .new-item-number {
                color: #999;
                font-size: 12px;
                font-weight: 600;
                min-width: 18px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .new-item-rank {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 8px;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
            }
            
            .new-item-rank.top { background: #dc2626; }
            .new-item-rank.high { background: #ea580c; }
            
            .new-item-content {
                flex: 1;
                min-width: 0;
            }
            
            .new-item-title {
                font-size: 14px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .error-section {
                background: #fef2f2;
                border: 1px solid #fecaca;
                border-radius: 8px;
                padding: 16px;
                margin-bottom: 24px;
            }
            
            .error-title {
                color: #dc2626;
                font-size: 14px;
                font-weight: 600;
                margin: 0 0 8px 0;
            }
            
            .error-list {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            
            .error-item {
                color: #991b1b;
                font-size: 13px;
                padding: 2px 0;
                font-family: 'SF Mono', Consolas, monospace;
            }
            
            .footer {
                margin-top: 32px;
                padding: 20px 24px;
                background: #f8f9fa;
                border-top: 1px solid #e5e7eb;
                text-align: center;
            }
            
            .footer-content {
                font-size: 13px;
                color: #6b7280;
                line-height: 1.6;
            }
            
            .footer-link {
                color: #4f46e5;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.2s ease;
            }
            
            .footer-link:hover {
                color: #7c3aed;
                text-decoration: underline;
            }
            
            .project-name {
                font-weight: 600;
                color: #374151;
            }
            
            @media (max-width: 480px) {
                body { padding: 12px; }
                .header { padding: 24px 20px; }
                .content { padding: 20px; }
                .footer { padding: 16px 20px; }
                .header-info { grid-template-columns: 1fr; gap: 12px; }
                .news-header { gap: 6px; }
                .news-content { padding-right: 45px; }
                .news-item { gap: 8px; }
                .new-item { gap: 8px; }
                .news-number { width: 20px; height: 20px; font-size: 12px; }
                .save-buttons {
                    position: static;
                    margin-bottom: 16px;
                    display: flex;
                    gap: 8px;
                    justify-content: center;
                    flex-direction: column;
                    width: 100%;
                }
                .save-btn {
                    width: 100%;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="save-buttons">
                    <button class="save-btn" onclick="saveAsImage()">保存为图片</button>
                    <button class="save-btn" onclick="saveAsMultipleImages()">分段保存</button>
                </div>
                <div class="header-title">热点新闻分析</div>
                <div class="header-info">
                    <div class="info-item">
                        <span class="info-label">报告类型</span>
                        <span class="info-value">当日汇总</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">新闻总数</span>
                        <span class="info-value">295 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">热点新闻</span>
                        <span class="info-value">38 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">生成时间</span>
                        <span class="info-value">11-14 16:29</span>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">药品 药物 制药 药企 医药 医疗 医院 医生 护士 治疗 疗法 疫苗 抗体 细胞 基因 DNA RNA 蛋白质 病毒 细菌 感染 疾病 病症 诊断 检查 手术 康复 健康 保健 营养 维生素 中药 西药 处方药 非处方药 抗生素 消炎药 止痛药 降压药 降糖药 抗癌药 化疗 放疗 免疫 免疫力 病理 生理 药理 毒理 临床 试验 研发 开发 生产 制造 质量 安全 监管 审批 FDA CFDA GMP GLP 医疗器械 设备 注射器 输液 输血 化验 检验 B超 CT MRI X光 心电图 血压计 血糖仪 体温计 口罩 防护服 消毒 灭菌 无菌 卫生 防疫 流行病 传染病 慢性病 急性病 过敏 副作用 不良反应 禁忌 说明书 剂量 用法 用量 疗程 复诊 随访 医保 保险 费用 价格 成本 专利 仿制药 原料药 辅料 包材 储存 运输 冷链 配送 药店 药房 连锁 门诊 急诊 住院 病房 ICU 护理 陪护 家属 病历 档案 电子病历 远程医疗 互联网+ 大数据 AI诊断 智能 数字化 信息化 系统 软件 硬件 网络 云端 区块链 物联网 可穿戴 传感器 监测 检测 筛查 预防 体检 疫苗接种 养生 养老 医养结合 康养 康复 理疗 针灸 推拿 拔罐 刮痧 食疗 药膳 保健食品 功能食品 膳食补充剂 益生菌 酶 激素 神经 内分泌 心血管 呼吸 消化 泌尿 生殖 骨骼 肌肉 皮肤 眼科 耳鼻喉 口腔 妇科 儿科 男科 肿瘤 精神 心理 神经科 传染科 重症医学 麻醉 疼痛 康复医学 预防医学 全科医学 家庭医生 私人医生 在线问诊 预约挂号 分级诊疗 医联体 公立医院 民营医院 专科医院 综合医院 医学院 医科大学 附属医院 教学 科研 学术 论文 期刊 会议 论坛 展会 博览会 协会 学会 基金会 慈善 公益 捐赠 援助 政策 法规 法律 条例 标准 规范 指南 共识 伦理 道德 人文 文化 教育 培训 继续教育 进修 实习 规培 执业医师 执业药师 职称 晋升 绩效 考核 薪酬 待遇 福利 就业 招聘 人才 专家 院士 教授 主任医师 副主任医师 主治医师 住院医师 药师 技师 护士长 护理师 实习生 志愿者 患者 病人 就诊 就医 挂号 排队 等待 满意度 投诉 纠纷 医患关系 沟通 交流 信任 理解 尊重 隐私 保密 知情同意 自主权 选择权 决定权 生命权 健康权 医疗权 公平 公正 公开 透明 监督 举报 维权 诉讼 仲裁 调解 协商 和解 赔偿 补偿 责任 义务 权利 保障 安全 有效 质量可控 稳定性 一致性 等效性 生物等效 药代动力学 药效学 毒代动力学 安全性评价 有效性评价 风险效益比 获益风险评估 个体化用药 精准医疗 转化医学 循证医学 个性化 定制 罕见病 孤儿药 儿童用药 老年用药 孕妇用药 哺乳期用药 肝肾功能不全 药物相互作用 配伍禁忌 稳定性考察 有效期 储存条件 包装规格 剂型 片剂 胶囊 颗粒 口服液 注射剂 外用制剂 贴剂 喷雾剂 滴眼剂 滴鼻剂 栓剂 洗剂 软膏 凝胶 乳膏 气雾剂 粉雾剂 吸入剂 缓释制剂 控释制剂 肠溶制剂 靶向制剂 纳米制剂 微球 脂质体 微囊 植入剂 透皮吸收 经皮给药 静脉注射 肌肉注射 皮下注射 动脉注射 鞘内注射 腹腔注射 关节腔注射 玻璃酸钠 甘露醇 氯化钠 葡萄糖 氯化钾 碳酸氢钠 乳酸钠 复方 组合 联合用药 序贯治疗 维持治疗 巩固治疗 诱导治疗 强化治疗 支持治疗 对症治疗 对因治疗 替代治疗 补充治疗 预防性用药 治疗性用药 急救用药 长期用药 短期用药 间歇用药 连续用药 按需用药 规律用药 按时用药 按量用药 足疗程 足剂量 最小有效剂量 最大耐受剂量 中毒剂量 致死剂量 半数致死量 半数有效量 治疗指数 安全范围 治疗窗 个体差异 种族差异 性别差异 年龄差异 体重差异 遗传多态性 药物代谢酶 CYP450 UGT NAT GST 药物转运体 P糖蛋白 有机阴离子转运体 有机阳离子转运体 药物靶点 受体 酶 离子通道 核酸 蛋白质合成 细胞周期 凋亡 坏死 自噬 necrosis apoptosis autophagy mitochondria cytoplasm nucleus membrane cell wall capsule flagellum pili plasmid chromosome genome proteome metabolome transcriptome metagenome microbiome microbiota flora fauna pathogen pathogenic virulence infectivity contagious epidemic pandemic outbreak endemic sporadic cluster nosocomial iatrogenic idiopathic congenital acquired hereditary genetic chromosomal multifactorial polygenic monogenic autosomal sex-linked dominant recessive codominant incomplete dominance variable expressivity penetrance pleiotropy anticipation genomic imprinting uniparental disomy mitochondrial inheritance mutation deletion duplication inversion translocation insertion substitution frameshift nonsense missense silent neutral beneficial deleterious polymorphism SNP indel copy number variation structural variation aneuploidy haploid diploid polyploid karyotype chromatid centromere telomere kinetochore spindle microtubule cytokinesis meiosis mitosis gamete zygote embryo fetus neonate infant toddler preschooler school-age adolescent adult middle-aged elderly senescence aging longevity lifespan healthspan quality of life well-being happiness mental health physical health social health spiritual health environmental health occupational health public health community health global health international health tropical medicine travel medicine aviation medicine space medicine sports medicine emergency medicine disaster medicine military medicine naval medicine aerospace medicine underwater medicine hyperbaric medicine hypobaric medicine radiation medicine nuclear medicine forensic medicine legal medicine toxicology pharmacology pharmaceutics pharmacokinetics pharmacodynamics pharmacogenomics pharmacoproteomics pharmacometabolomics pharmacoeconomics pharmacovigilance drug discovery drug development drug delivery drug targeting drug resistance multidrug resistance cross-resistance collateral sensitivity synthetic lethality drug repositioning drug repurposing precision medicine personalized medicine systems medicine regenerative medicine translational medicine comparative medicine experimental medicine molecular medicine cellular medicine tissue engineering biomaterials biocompatibility bioactivity bioavailability bioequivalence biopharmaceutics biostatistics bioinformatics computational biology systems biology network biology synthetic biology chemical biology structural biology molecular biology cell biology developmental biology evolutionary biology ecological biology marine biology plant biology animal biology microbiology virology bacteriology mycology parasitology immunology immunochemistry immunobiology immunopathology immunogenetics immunophenotyping immunotherapy allergy hypersensitivity anaphylaxis autoimmunity autoimmune disease immunodeficiency primary immunodeficiency secondary immunodeficiency combined immunodeficiency severe combined immunodeficiency common variable immunodeficiency selective IgA deficiency DiGeorge syndrome Wiskott-Aldrich syndrome chronic granulomatous disease leukocyte adhesion deficiency hyper-IgE syndrome immunodysregulation immunosenescence immunomodulation immunosuppression immunostimulation immunoenhancement immunoadjuvant immunoassay ELISA RIA FACS flow cytometry cytometry microscopy electron microscopy confocal microscopy fluorescence microscopy phase contrast microscopy bright field microscopy dark field microscopy polarized light microscopy fluorescence resonance energy transfer FRET bioluminescence resonance energy transfer BRET surface plasmon resonance SPR isothermal titration calorimetry ITC circular dichroism CD nuclear magnetic resonance NMR mass spectrometry MS gas chromatography GC liquid chromatography LC high performance liquid chromatography HPLC ultra performance liquid chromatography UPLC thin layer chromatography TLC paper chromatography gel electrophoresis agarose gel electrophoresis polyacrylamide gel electrophoresis PAGE capillary electrophoresis CE isoelectric focusing IEF two-dimensional electrophoresis 2DE difference gel electrophoresis DIGE chromatofocusing hydrophobic interaction chromatography HIC ion exchange chromatography IEC size exclusion chromatography SEC affinity chromatography AC reverse phase chromatography RPC normal phase chromatography NPC chiral chromatography CC supercritical fluid chromatography SFC micellar electrokinetic chromatography MEKC capillary electrochromatography CEC immobilized metal affinity chromatography IMAC hydroxyapatite chromatography HAC lectin affinity chromatography LAC boronate affinity chromatography BAC dye ligand chromatography DLC protein A chromatography Protein A protein G chromatography Protein G heparin affinity chromatography HA</div>
                            <div class="word-count hot">38 条</div>
                        </div>
                        <div class="word-index">1/1</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num top">2</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759330" target="_blank" class="news-link">腾讯电话会：2025年全年实际资本支出将低于指引，GPU储备足够内部使用，微信最终将推出一个AI智能体</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num top">2</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1971848892699080387" target="_blank" class="news-link">荒野求生 5 名选手血钾超标，这是哪些因素造成的？血钾异常对选手后续比赛和健康有何潜在影响？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num top">1-4</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7571576531525419027/" target="_blank" class="news-link">神二十返回舱玻璃现裂纹 将留轨试验</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num top">2-3</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2200326" target="_blank" class="news-link">华尔街警告声愈发强烈！专家：AI泡沫终将带来损失，信贷“蟑螂”比比皆是！</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num top">3</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7571815318490795526/" target="_blank" class="news-link">香港志愿者：为全运 更精彩</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num top">3</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2305113" target="_blank" class="news-link">我国完成第一阶段6G技术试验</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num high">4</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31964898" target="_blank" class="news-link">视频丨海军四川舰开展首次航行试验，创新应用电磁弹射和阻拦技术</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">7</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E7%A5%9E%E4%BA%8C%E5%8D%81%E9%A3%9E%E8%88%B9%E7%8E%BB%E7%92%83%E7%BB%86%E5%BE%AE%E8%A3%82%E7%BA%B9+%E5%B0%86%E7%95%99%E8%BD%A8%E8%AF%95%E9%AA%8C" target="_blank" class="news-link">神二十飞船玻璃细微裂纹 将留轨试验</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">7</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2305738" target="_blank" class="news-link">荒野求生“冷美人”体检未过退赛</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">7-8</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E7%A5%9E20%E7%BB%A7%E7%BB%AD%E7%95%99%E8%BD%A8%E5%BC%80%E5%B1%95%E7%9B%B8%E5%85%B3%E8%AF%95%E9%AA%8C" target="_blank" class="news-link">神20继续留轨开展相关试验</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">7-9</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.weibo.cn/search?containerid=100103type%3D1%26t%3D10%26q%3D%23%E8%B6%85%E5%85%AD%E6%88%90%E7%B3%96%E5%B0%BF%E7%97%85%E5%89%8D%E6%9C%9F%E6%82%A3%E8%80%85%E8%87%AA%E5%B7%B1%E6%B2%A1%E6%84%9F%E8%A7%89%23&amp;stream_entry_id=31&amp;isnewpage=1&amp;extparam=seat%3D1%26realpos%3D9%26pos%3D10%26lcate%3D5001%26cate%3D5001%26dgr%3D0%26flag%3D0%26q%3D%2523%25E8%25B6%2585%25E5%2585%25AD%25E6%2588%2590%25E7%25B3%2596%25E5%25B0%25BF%25E7%2597%2585%25E5%2589%258D%25E6%259C%259F%25E6%2582%25A3%25E8%2580%2585%25E8%2587%25AA%25E5%25B7%25B1%25E6%25B2%25A1%25E6%2584%259F%25E8%25A7%2589%2523%26stream_entry_id%3D31%26c_type%3D31%26band_rank%3D9%26filter_type%3Drealtimehot%26display_time%3D1763106595%26pre_seqid%3D176310659584901151006123&amp;launchid=10000360-page_H5" target="_blank" class="news-link">超六成糖尿病前期患者自己没感觉</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">8</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3759324" target="_blank" class="news-link">吴清主席访问法国、巴西金融监管部门并与国际机构投资者代表座谈</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">8-10</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2304331" target="_blank" class="news-link">学会了鸡冠洞大爷的反向宣传</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">9</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1972607882588546272" target="_blank" class="news-link">海军四川舰开展首次航行试验，作为海军新一代两栖攻击舰，其性能如何？有哪些亮点值得关注？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">9-10</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31956972" target="_blank" class="news-link">双江口红旗桥引桥垮塌事故回看：边坡治理对桥梁安全意味着什么</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">16</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">11-12</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31966454" target="_blank" class="news-link">上海通报“绿捷食安事件”：已查明违法犯罪事实，公司8名责任人被依法执行逮捕</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">17</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">12-14</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E6%B5%B7%E5%86%9B%E5%9B%9B%E5%B7%9D%E8%88%B0%E5%BC%80%E5%B1%95%E9%A6%96%E6%AC%A1%E8%88%AA%E8%A1%8C%E8%AF%95%E9%AA%8C" target="_blank" class="news-link">海军四川舰开展首次航行试验</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">18</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">凤凰网</span><span class="rank-num ">12</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ifeng.com/c/8oGbHEB9VY0" target="_blank" class="news-link">“警察同志，我要举报我女朋友！”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">19</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">13-24</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7572160008454553663/" target="_blank" class="news-link">贾玲罕见公开露面又瘦了</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">20</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">16</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31963123" target="_blank" class="news-link">视频丨越野车车主撞向街头挥刀男子，专家解读：属正当防卫</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">21</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">17-19</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1972233864865875236" target="_blank" class="news-link">山西「反杀狗主人案」一审未宣判，其女儿称父亲系自卫反击，检方指控防卫过当，如何从法律角度解读？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">22</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">18-20</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E5%8C%BB%E9%99%A2%E5%9B%9E%E5%BA%94%E7%88%B8%E7%88%B8%E4%B9%B0%E7%8C%AA%E8%82%89%E8%AE%B0%E5%8F%B7%E7%AC%94%E7%BB%99%E5%A8%83%E7%9B%96%E7%AB%A0" target="_blank" class="news-link">医院回应爸爸买猪肉记号笔给娃盖章</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">23</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">18</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31958301" target="_blank" class="news-link">成都通报“和平小屋”事：监督整改自管小组无依据收费，社区书记停职</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">24</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">21-26</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7571626548642889737/" target="_blank" class="news-link">“私闯民宅”引血案 法律该如何判</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">25</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">21-22</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.weibo.cn/search?containerid=100103type%3D1%26t%3D10%26q%3D%23%E8%93%9D%E6%88%98%E9%9D%9E%E8%BD%A6%E7%A5%B8%E4%BC%A4%E5%8F%A3%E6%84%9F%E6%9F%93%23&amp;stream_entry_id=31&amp;isnewpage=1&amp;extparam=seat%3D1%26realpos%3D21%26pos%3D22%26lcate%3D5001%26cate%3D5001%26dgr%3D0%26flag%3D1%26q%3D%2523%25E8%2593%259D%25E6%2588%2598%25E9%259D%259E%25E8%25BD%25A6%25E7%25A5%25B8%25E4%25BC%25A4%25E5%258F%25A3%25E6%2584%259F%25E6%259F%2593%2523%26stream_entry_id%3D31%26c_type%3D31%26band_rank%3D21%26filter_type%3Drealtimehot%26display_time%3D1763106595%26pre_seqid%3D176310659584901151006123&amp;launchid=10000360-page_H5" target="_blank" class="news-link">蓝战非车祸伤口感染</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">26</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">23-27</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E6%BD%9C%E6%B0%B4%E5%91%98%E6%B0%B4%E4%B8%8B%E5%85%B3%E9%97%AD%E4%BB%96%E4%BA%BA%E6%B0%94%E7%93%B6%EF%BC%9F%E5%8D%8F%E4%BC%9A%E5%9B%9E%E5%BA%94" target="_blank" class="news-link">潜水员水下关闭他人气瓶？协会回应</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">27</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">25-26</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E8%91%97%E5%90%8D%E7%A5%9E%E7%BB%8F%E7%97%85%E5%AD%A6%E5%AE%B6%E8%92%8B%E9%9B%A8%E5%B9%B3%E5%9B%A0%E7%97%85%E9%80%9D%E4%B8%96" target="_blank" class="news-link">著名神经病学家蒋雨平因病逝世</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">28</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">25</span><span class="time-info">15时51分~16时29分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2305607" target="_blank" class="news-link">神二十玻璃现裂纹将留轨试验</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">29</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">11-12</span><span class="time-info">16时12分~16时29分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2200709" target="_blank" class="news-link">上海通报“绿捷食安事件”：吊销“双证”，8名责任人被逮捕</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">30</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">12-14</span><span class="time-info">16时12分~16时29分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1972672588388987668" target="_blank" class="news-link">上海通报学校午餐发臭事件，已查明违法犯罪事实，8 名责任人被逮捕，起到哪些警示作用？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">31</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">15-30</span><span class="time-info">15时51分~16时14分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7572430152991247935/" target="_blank" class="news-link">专家：四川舰搭载30架攻击21不是梦</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">32</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">18-24</span><span class="time-info">15时51分~16时14分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7572427396968615470/" target="_blank" class="news-link">专家：四川舰与真正的航母仍有区别</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">33</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">30</span><span class="time-info">15时51分~16时14分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E4%BA%8E%E4%B8%9C%E6%9D%A5%EF%BC%9A%E5%BC%98%E6%89%AC%E8%89%AF%E5%A5%BD%E9%A3%8E%E4%BF%97%E6%96%87%E5%8C%96+%E4%B8%8D%E8%A6%81%E5%BD%A9%E7%A4%BC" target="_blank" class="news-link">于东来：弘扬良好风俗文化 不要彩礼</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">34</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">12</span><span class="time-info">16时29分</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2200848" target="_blank" class="news-link">实探哪吒汽车桐乡工厂：无复工迹象、管理人驻厂办公 第二次债权人会议即将召开</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">35</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">15</span><span class="time-info">16时29分</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31899580" target="_blank" class="news-link">影子调查｜连云港一公司女职员陪酒之死：赴宴5名镇干部被处理，家属起诉追问死因</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">36</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">16</span><span class="time-info">15时51分</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1972211869725990989" target="_blank" class="news-link">2025 年院士增选进入最后环节，结果即将公布，对此你有什么期待？你对所在领域的人选，有哪些期待？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">37</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">23</span><span class="time-info">16时29分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7572313948905619492/" target="_blank" class="news-link">专家解读神二十航天员返回地球</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">38</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">25</span><span class="time-info">16时29分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7571764020798849074/" target="_blank" class="news-link">专家解析日本右翼涉台言论</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="new-section">
                    <div class="new-section-title">本次新增热点 (共 4 条)</div>
                    <div class="new-source-group">
                        <div class="new-source-title">今日头条 · 2条</div>
                        <div class="new-item">
                            <div class="new-item-number">1</div>
                            <div class="new-item-rank ">23</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://www.toutiao.com/trending/7572313948905619492/" target="_blank" class="news-link">专家解读神二十航天员返回地球</a>
                                </div>
                            </div>
                        </div>
                        <div class="new-item">
                            <div class="new-item-number">2</div>
                            <div class="new-item-rank ">25</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://www.toutiao.com/trending/7571764020798849074/" target="_blank" class="news-link">专家解析日本右翼涉台言论</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="new-source-group">
                        <div class="new-source-title">澎湃新闻 · 1条</div>
                        <div class="new-item">
                            <div class="new-item-number">1</div>
                            <div class="new-item-rank ">15</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://m.thepaper.cn/newsDetail_forward_31899580" target="_blank" class="news-link">影子调查｜连云港一公司女职员陪酒之死：赴宴5名镇干部被处理，家属起诉追问死因</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="new-source-group">
                        <div class="new-source-title">财联社热门 · 1条</div>
                        <div class="new-item">
                            <div class="new-item-number">1</div>
                            <div class="new-item-rank ">12</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://www.cls.cn/detail/2200848" target="_blank" class="news-link">实探哪吒汽车桐乡工厂：无复工迹象、管理人驻厂办公 第二次债权人会议即将召开</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <div class="footer-content">
                    由 <span class="project-name">TrendRadar</span> 生成 · 
                    <a href="https://github.com/sansan0/TrendRadar" target="_blank" class="footer-link">
                        GitHub 开源项目
                    </a>
                </div>
            </div>
        </div>
        
        <script>
            async function saveAsImage() {
                const button = event.target;
                const originalText = button.textContent;
                
                try {
                    button.textContent = '生成中...';
                    button.disabled = true;
                    window.scrollTo(0, 0);
                    
                    // 等待页面稳定
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // 截图前隐藏按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 再次等待确保按钮完全隐藏
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const container = document.querySelector('.container');
                    
                    const canvas = await html2canvas(container, {
                        backgroundColor: '#ffffff',
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 10000,
                        removeContainer: false,
                        foreignObjectRendering: false,
                        logging: false,
                        width: container.offsetWidth,
                        height: container.offsetHeight,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    buttons.style.visibility = 'visible';
                    
                    const link = document.createElement('a');
                    const now = new Date();
                    const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}.png`;
                    
                    link.download = filename;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    // 触发下载
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    button.textContent = '保存成功!';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            async function saveAsMultipleImages() {
                const button = event.target;
                const originalText = button.textContent;
                const container = document.querySelector('.container');
                const scale = 1.5; 
                const maxHeight = 5000 / scale;
                
                try {
                    button.textContent = '分析中...';
                    button.disabled = true;
                    
                    // 获取所有可能的分割元素
                    const newsItems = Array.from(container.querySelectorAll('.news-item'));
                    const wordGroups = Array.from(container.querySelectorAll('.word-group'));
                    const newSection = container.querySelector('.new-section');
                    const errorSection = container.querySelector('.error-section');
                    const header = container.querySelector('.header');
                    const footer = container.querySelector('.footer');
                    
                    // 计算元素位置和高度
                    const containerRect = container.getBoundingClientRect();
                    const elements = [];
                    
                    // 添加header作为必须包含的元素
                    elements.push({
                        type: 'header',
                        element: header,
                        top: 0,
                        bottom: header.offsetHeight,
                        height: header.offsetHeight
                    });
                    
                    // 添加错误信息（如果存在）
                    if (errorSection) {
                        const rect = errorSection.getBoundingClientRect();
                        elements.push({
                            type: 'error',
                            element: errorSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 按word-group分组处理news-item
                    wordGroups.forEach(group => {
                        const groupRect = group.getBoundingClientRect();
                        const groupNewsItems = group.querySelectorAll('.news-item');
                        
                        // 添加word-group的header部分
                        const wordHeader = group.querySelector('.word-header');
                        if (wordHeader) {
                            const headerRect = wordHeader.getBoundingClientRect();
                            elements.push({
                                type: 'word-header',
                                element: wordHeader,
                                parent: group,
                                top: groupRect.top - containerRect.top,
                                bottom: headerRect.bottom - containerRect.top,
                                height: headerRect.height
                            });
                        }
                        
                        // 添加每个news-item
                        groupNewsItems.forEach(item => {
                            const rect = item.getBoundingClientRect();
                            elements.push({
                                type: 'news-item',
                                element: item,
                                parent: group,
                                top: rect.top - containerRect.top,
                                bottom: rect.bottom - containerRect.top,
                                height: rect.height
                            });
                        });
                    });
                    
                    // 添加新增新闻部分
                    if (newSection) {
                        const rect = newSection.getBoundingClientRect();
                        elements.push({
                            type: 'new-section',
                            element: newSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 添加footer
                    const footerRect = footer.getBoundingClientRect();
                    elements.push({
                        type: 'footer',
                        element: footer,
                        top: footerRect.top - containerRect.top,
                        bottom: footerRect.bottom - containerRect.top,
                        height: footer.offsetHeight
                    });
                    
                    // 计算分割点
                    const segments = [];
                    let currentSegment = { start: 0, end: 0, height: 0, includeHeader: true };
                    let headerHeight = header.offsetHeight;
                    currentSegment.height = headerHeight;
                    
                    for (let i = 1; i < elements.length; i++) {
                        const element = elements[i];
                        const potentialHeight = element.bottom - currentSegment.start;
                        
                        // 检查是否需要创建新分段
                        if (potentialHeight > maxHeight && currentSegment.height > headerHeight) {
                            // 在前一个元素结束处分割
                            currentSegment.end = elements[i - 1].bottom;
                            segments.push(currentSegment);
                            
                            // 开始新分段
                            currentSegment = {
                                start: currentSegment.end,
                                end: 0,
                                height: element.bottom - currentSegment.end,
                                includeHeader: false
                            };
                        } else {
                            currentSegment.height = potentialHeight;
                            currentSegment.end = element.bottom;
                        }
                    }
                    
                    // 添加最后一个分段
                    if (currentSegment.height > 0) {
                        currentSegment.end = container.offsetHeight;
                        segments.push(currentSegment);
                    }
                    
                    button.textContent = `生成中 (0/${segments.length})...`;
                    
                    // 隐藏保存按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 为每个分段生成图片
                    const images = [];
                    for (let i = 0; i < segments.length; i++) {
                        const segment = segments[i];
                        button.textContent = `生成中 (${i + 1}/${segments.length})...`;
                        
                        // 创建临时容器用于截图
                        const tempContainer = document.createElement('div');
                        tempContainer.style.cssText = `
                            position: absolute;
                            left: -9999px;
                            top: 0;
                            width: ${container.offsetWidth}px;
                            background: white;
                        `;
                        tempContainer.className = 'container';
                        
                        // 克隆容器内容
                        const clonedContainer = container.cloneNode(true);
                        
                        // 移除克隆内容中的保存按钮
                        const clonedButtons = clonedContainer.querySelector('.save-buttons');
                        if (clonedButtons) {
                            clonedButtons.style.display = 'none';
                        }
                        
                        tempContainer.appendChild(clonedContainer);
                        document.body.appendChild(tempContainer);
                        
                        // 等待DOM更新
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        // 使用html2canvas截取特定区域
                        const canvas = await html2canvas(clonedContainer, {
                            backgroundColor: '#ffffff',
                            scale: scale,
                            useCORS: true,
                            allowTaint: false,
                            imageTimeout: 10000,
                            logging: false,
                            width: container.offsetWidth,
                            height: segment.end - segment.start,
                            x: 0,
                            y: segment.start,
                            windowWidth: window.innerWidth,
                            windowHeight: window.innerHeight
                        });
                        
                        images.push(canvas.toDataURL('image/png', 1.0));
                        
                        // 清理临时容器
                        document.body.removeChild(tempContainer);
                    }
                    
                    // 恢复按钮显示
                    buttons.style.visibility = 'visible';
                    
                    // 下载所有图片
                    const now = new Date();
                    const baseFilename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
                    
                    for (let i = 0; i < images.length; i++) {
                        const link = document.createElement('a');
                        link.download = `${baseFilename}_part${i + 1}.png`;
                        link.href = images[i];
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // 延迟一下避免浏览器阻止多个下载
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                    
                    button.textContent = `已保存 ${segments.length} 张图片!`;
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('分段保存失败:', error);
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            document.addEventListener('DOMContentLoaded', function() {
                window.scrollTo(0, 0);
            });
        </script>
    </body>
    </html>
    